%% Exercise 01 — Stakeholder Onion Diagram (Task 2: Delivery of orders)
%% Mermaid format
%% Date added: PIM_02

%% Diagram shows the system in the center and concentric layers (onion)
%% Layers (from center outward): System, Core users/operators, Supporting roles & systems, External partners & customers, Regulators / Stakeholders

flowchart TB
  subgraph onion["Onion diagram — Delivery system"]
    direction TB
    sys(("Delivery system"))

    %% Layer 1: Core system users / actors (closest to system)
    subgraph L1["Core users / Operators (Layer 1)"]
      direction LR
      courier["Курьер\n(mobile app)"]
      dispatcher["Диспетчер\n(web UI)"]
      operator["Оператор ввода заказов\n(web UI)"]
      admin["Администратор системы\n(admin panel)"]
    end

    %% Layer 2: Supporting roles & internal teams
    subgraph L2["Supporting roles & teams (Layer 2)"]
      direction LR
      dev["Команда разработки / DevOps"]
      support["Служба поддержки клиентов"]
      finance["Бухгалтерия (интеграция)"]
    end

    %% Layer 3: External partners and suppliers
    subgraph L3["External partners & suppliers (Layer 3)"]
      direction LR
      shop["Магазины / Поставщики (создают заказы)"]
      fulfil["Партнёры по логистике / fulfilment"]
      payments["Провайдер платежей\n(payment gateway)"]
    end

    %% Layer 4: Customers and regulators (outermost)
    subgraph L4["Customers & Regulators (Layer 4)"]
      direction LR
      customer["Клиент (получатель заказа)"]
      regulators["Регуляторы / муниципалитеты"]
      competitors["Конкуренты (внешнее влияние)"]
    end

  end

  %% Connections to the system
  sys --- courier
  sys --- dispatcher
  sys --- operator
  sys --- admin

  %% Supporting teams connect to core actors and system
  dev --- sys
  support --- sys
  finance --- sys
  dev --- admin
  support --- operator
  finance --- admin

  %% External partners
  shop --- operator
  shop --- sys
  fulfil --- sys
  payments --- sys
  payments --- customer

  %% Customers and regulators
  customer --- courier
  customer --- sys
  regulators --- sys
  competitors -.-> sys

  %% Notes
  classDef layer fill:#f8f9fa,stroke:#bbb,stroke-width:1px;
  class L1,L2,L3,L4 layer;
